Sub VBAChallenge():
    
'loop through worksheets
    Dim ws As Worksheet
    For Each ws In Worksheets

    ' label the columns on the sheet
        ws.Range("I1:L1").Value = Array("Ticker Symbol", "Yearly Change", "Percent Change", "Total Stock Volume")
        
        'Find the end
        Dim LastRow As Long
        LastRow = ws.Cells(Rows.Count, 1).End(xlUp).Row
        
        'name the variables:
        Dim Column As Integer
        Dim Summary_Table_Row As Integer
        
        Dim Open_Price As Double
        Dim Close_Price As Double
        Dim Change_Value As Double
        Dim Percent_Change As Double
        Dim Stock_Total As Double

        'Starting place:
        Summary_Table_Row = 2
        Column = 1
        
        Open_Price = Cells(2, 3).Value
        Stock_Total = Cells(2, 7).Value
               
            For I = 2 To LastRow
                If ws.Cells(I + 1, Column).Value <> ws.Cells(I, Column).Value Then
                
                    'add code to write ticker in column I
                    ws.Range("I" & Summary_Table_Row).Value = ws.Cells(I, Column).Value
                    
                    'find your closing price
                    Close_Price = ws.Cells(I, 6).Value
                    
                    'Find the yearly change
                    Change_Price = Close_Price - Open_Price
                    
                    'Print the yearly change in column J
                    ws.Range("J" & Summary_Table_Row).Value = Change_Price
                    
                    'Find the percent change (final multiplication done with formatting
                        
                        If Open_Price = 0 Then
                        Percent_Change = "0"
                        
                        Else
                        Percent_Change = (Change_Price / Open_Price)
                        
                        End If
        
                    'Print the percent change in column K
                    ws.Range("K" & Summary_Table_Row).Value = Percent_Change
                    
                     'Add formatting to column K (%) format cells 2 places past decimal place (REQUIRED)
                    ws.Range("K" & Summary_Table_Row).NumberFormat = "0.00%"
                           
                    'Find the total volume of stock
                    Stock_Total = Stock_Total + ws.Cells(I, 7).Value
                    
                    'Print the volume of stock in column L
                    ws.Range("L" & Summary_Table_Row).Value = Stock_Total
                    
                'RESET
                    'Store the next Open Price
                    Open_Price = ws.Cells(I + 1, 3).Value
                    
                    'Store the next Stock Volume
                    Stock_Total = ws.Cells(I + 1, 7).Value
                    
                    'add code to write the next entry on the next line down on the table
                    Summary_Table_Row = Summary_Table_Row + 1
                    
                Else
                    
                    'keep adding stock volume
                    Stock_Volume = Stock_Volume + ws.Cells(I, 7).Value
                    
                End If
                
            Next I
        
     'Additional Formatting
                    
        'Find the last cell to format
        Dim LastCell As Double
        Dim Column_Change As Range
        LastCell = ws.Cells(Rows.Count, 1).End(xlUp).Row
        
              
        'In Column K, highlight positive change in green and negative change in red (REQUIRED)
            
        For I = 2 To LastCell
            
            If ws.Cells(I, 11).Value > 0 Then
                ws.Cells(I, 11).Interior.ColorIndex = 4
                
            ElseIf ws.Cells(I, 11).Value < 0 Then
                ws.Cells(I, 11).Interior.ColorIndex = 3
        
            End If
    
    Next
    
    MsgBox ("Worksheet " & ws.Name & " complete")
    
    Next ws
   MsgBox ("Finished")
   
End Sub
